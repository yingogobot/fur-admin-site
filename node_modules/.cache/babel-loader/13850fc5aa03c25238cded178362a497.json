{"remainingRequest":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/thread-loader/dist/cjs.js!/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/babel-loader/lib/index.js!/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/src/views/inventory/storage-check.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/src/views/inventory/storage-check.vue","mtime":1576573214586},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread2\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getStorage } from '@/api/inventory';\nimport { getAllProductType, getProductSubType, getProductBySubType } from '@/api/product';\nimport waves from '@/directive/waves'; // waves directive\n\nimport { parseTime } from '@/utils';\nimport Pagination from '@/components/Pagination'; // secondary package based on el-pagination\n\nimport { mapGetters } from 'vuex';\nexport default {\n  name: 'ComplexTable',\n  components: {\n    Pagination: Pagination\n  },\n  directives: {\n    waves: waves\n  },\n  filters: {},\n  data: function data() {\n    return {\n      tableKey: 0,\n      inventories: null,\n      productTypes: [],\n      productSubTypes: [],\n      selectedProducts: [],\n      total: 0,\n      listLoading: true,\n      rowSpans: null,\n      listQuery: {\n        page: 1,\n        limit: 10,\n        product_type: undefined,\n        product_sub_type: undefined,\n        product: undefined\n      }\n    };\n  },\n  created: function created() {\n    this.getAllStorage();\n    this.getProductTypes();\n  },\n  computed: _objectSpread({}, mapGetters(['id'])),\n  methods: {\n    getAllStorage: function getAllStorage() {\n      var _this = this;\n\n      this.listLoading = true;\n      getStorage().then(function (response) {\n        _this.inventories = response;\n        _this.listLoading = false;\n\n        _this.calculateRowSpan();\n      }).catch(function (err) {\n        _this.$message({\n          message: '读取库存失败，请联系徐神检查',\n          type: 'error'\n        });\n\n        _this.listLoading = false;\n      });\n    },\n    getProductTypes: function getProductTypes() {\n      var _this2 = this;\n\n      getAllProductType().then(function (response) {\n        _this2.productTypes = response;\n      });\n    },\n    getSubType: function getSubType(productType, item) {\n      var _this3 = this;\n\n      this.listQuery.product = undefined;\n      this.listQuery.product_sub_type = undefined;\n      this.productSubTypes = [];\n      this.selectedProducts = [];\n\n      if (productType) {\n        getProductSubType({\n          product_type_id: productType\n        }).then(function (response) {\n          _this3.productSubTypes = response;\n        });\n      }\n\n      if (item) {\n        item.product_sub_type = undefined;\n        item.product_id = undefined;\n        item.cost = undefined;\n        item.size = undefined;\n        item.quantity = undefined;\n      }\n    },\n    getSelectedProducts: function getSelectedProducts(subType) {\n      var _this4 = this;\n\n      this.listQuery.product = undefined;\n      this.selectedProducts = [];\n\n      if (subType) {\n        getProductBySubType({\n          product_sub_type: subType\n        }).then(function (response) {\n          _this4.selectedProducts = response;\n        });\n      }\n    },\n    handleFilter: function handleFilter() {\n      this.listQuery.page = 1;\n      this.getAllStorage();\n    },\n    calculateRowSpan: function calculateRowSpan() {\n      var g = [];\n      var count = 0;\n      this.inventories.forEach(function (i) {\n        var found = false;\n        g.forEach(function (t) {\n          if (t.id === i.product_sub_type_id) {\n            found = true;\n            t.end++;\n            t.rowSpan++;\n            count = t.start + t.rowSpan;\n          }\n        });\n\n        if (!found) {\n          var newT = {\n            id: i.product_sub_type_id,\n            start: count,\n            end: count + 1,\n            rowSpan: 1\n          };\n          count++;\n          g.push(newT);\n        }\n      });\n      console.log(g);\n      this.rowSpans = g;\n    },\n    objectSpanMethod: function objectSpanMethod(_ref) {\n      var row = _ref.row,\n          column = _ref.column,\n          rowIndex = _ref.rowIndex,\n          columnIndex = _ref.columnIndex;\n\n      if (columnIndex === 1 || columnIndex === 2) {\n        var data = {\n          rowspan: 0,\n          colspan: 0\n        };\n        this.rowSpans.forEach(function (i) {\n          if (rowIndex >= i.start && rowIndex < i.end && (rowIndex - i.start) % i.rowSpan === 0) {\n            data = {\n              rowspan: i.rowSpan,\n              colspan: 1\n            };\n            return;\n          }\n        });\n        return data;\n      }\n    }\n  }\n};",null]}