{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{\"25re\":function(t,e,n){\"use strict\";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"pagination-container\",class:{hidden:t.hidden}},[n(\"el-pagination\",t._b({attrs:{background:t.background,\"current-page\":t.currentPage,\"page-size\":t.pageSize,layout:t.layout,\"page-sizes\":t.pageSizes,total:t.total},on:{\"update:currentPage\":function(e){t.currentPage=e},\"update:current-page\":function(e){t.currentPage=e},\"update:pageSize\":function(e){t.pageSize=e},\"update:page-size\":function(e){t.pageSize=e},\"size-change\":t.handleSizeChange,\"current-change\":t.handleCurrentChange}},\"el-pagination\",t.$attrs,!1))],1)},o=[];r._withStripped=!0,n.d(e,\"render\",function(){return r}),n.d(e,\"staticRenderFns\",function(){return o})},\"3TMG\":function(t,e,n){\"use strict\";n(\"rGqo\");var r=n(\"23J+\"),o=n(\"86NN\"),i=n(\"xMja\"),c=n(\"ZySA\"),u=(n(\"7Qib\"),n(\"Mz3J\")),a=n(\"L2JU\"),s={name:\"ComplexTable\",components:{Pagination:u.a},directives:{waves:c.a},filters:{},data:function(){return{tableKey:0,inventories:null,productTypes:[],productSubTypes:[],selectedProducts:[],total:0,listLoading:!0,rowSpans:null,listQuery:{page:1,limit:10,product_type:void 0,product_sub_type:void 0,product:void 0}}},created:function(){},computed:Object(r.a)({},Object(a.b)([\"id\"])),beforeRouteEnter:function(t,e,n){n(function(t){t.getAllStorage(),t.getProductTypes(),n()})},methods:{getAllStorage:function(){var t=this;this.listLoading=!0,o.a.getStorage().then(function(e){t.inventories=e,t.listLoading=!1,t.calculateRowSpan()}).catch(function(e){t.$message({message:\"读取库存失败，请联系徐神检查\",type:\"error\"}),t.listLoading=!1})},getProductTypes:function(){var t=this;i.a.getAllProductType().then(function(e){t.productTypes=e})},getSubType:function(t,e){var n=this;this.listQuery.product=void 0,this.listQuery.product_sub_type=void 0,this.productSubTypes=[],this.selectedProducts=[],t&&i.a.getProductSubType({product_type_id:t}).then(function(t){n.productSubTypes=t}),e&&(e.product_sub_type=void 0,e.product_id=void 0,e.cost=void 0,e.size=void 0,e.quantity=void 0)},getSelectedProducts:function(t){var e=this;this.listQuery.product=void 0,this.selectedProducts=[],t&&i.a.getProductBySubType({product_sub_type:t}).then(function(t){e.selectedProducts=t})},handleFilter:function(){this.listQuery.page=1,this.getAllStorage()},calculateRowSpan:function(){var t=[],e=0;this.inventories.forEach(function(n){var r=!1;if(t.forEach(function(t){t.id===n.product_sub_type_id&&(r=!0,t.end++,t.rowSpan++,e=t.start+t.rowSpan)}),!r){var o={id:n.product_sub_type_id,start:e,end:e+1,rowSpan:1};e++,t.push(o)}}),this.rowSpans=t},objectSpanMethod:function(t){t.row,t.column;var e=t.rowIndex,n=t.columnIndex;if(1===n||2===n){var r={rowspan:0,colspan:0};return this.rowSpans.forEach(function(t){e>=t.start&&e<t.end&&(e-t.start)%t.rowSpan==0&&(r={rowspan:t.rowSpan,colspan:1})}),r}}}};e.a=s},\"6g3Z\":function(t,e,n){\"use strict\";n(\"xfY5\");Math.easeInOutQuad=function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e};var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};function o(t,e,n){var o=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,i=t-o,c=0;e=void 0===e?500:e;!function t(){c+=20;var u,a=Math.easeInOutQuad(c,o,i,e);u=a,document.documentElement.scrollTop=u,document.body.parentNode.scrollTop=u,document.body.scrollTop=u,c<e?r(t):n&&\"function\"==typeof n&&n()}()}var i={name:\"Pagination\",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:\"total, sizes, prev, pager, next, jumper\"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit(\"update:page\",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit(\"update:limit\",t)}}},methods:{handleSizeChange:function(t){this.$emit(\"pagination\",{page:this.currentPage,limit:t}),this.autoScroll&&o(0,800)},handleCurrentChange:function(t){this.$emit(\"pagination\",{page:t,limit:this.pageSize}),this.autoScroll&&o(0,800)}}};e.a=i},\"86NN\":function(t,e,n){\"use strict\";var r=n(\"DyJX\");e.a={fetchAllInventorys:function(t){return new Promise(function(e,n){r.a.post(\"inventory/all_inventorys\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllInventoryCount:function(t){return new Promise(function(e,n){var o={inventory_type:t};r.a.post(\"inventory/count_inventorys\",o).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllInventoryTpes:function(t){return new Promise(function(e,n){var o={inventory_type:t};r.a.post(\"inventory/inventory_types\",o).then(function(t){return e(t)}).catch(function(t){return n(t)})})},addNewInventoryRequest:function(t){return new Promise(function(e,n){r.a.post(\"inventory/add\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getStorage:function(){return new Promise(function(t,e){r.a.post(\"inventory/storage\").then(function(e){return t(e)}).catch(function(t){return e(t)})})},getProductStorage:function(t){return new Promise(function(e,n){var o={product_id:t};r.a.post(\"inventory/storage\",o).then(function(t){return e(t)}).catch(function(t){return n(t)})})}}},LqgQ:function(t,e,n){\"use strict\";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"app-container\"},[n(\"div\",{staticClass:\"filter-container\"},[n(\"h2\",[t._v(\"筛选结果\")]),t._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"产品类型\",clearable:\"\"},on:{change:function(e){return t.getSubType(t.listQuery.product_type)}},model:{value:t.listQuery.product_type,callback:function(e){t.$set(t.listQuery,\"product_type\",e)},expression:\"listQuery.product_type\"}},t._l(t.productTypes,function(t){return n(\"el-option\",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),t._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"产品分类\",clearable:\"\"},on:{change:function(e){return t.getSelectedProducts(t.listQuery.product_sub_type)}},model:{value:t.listQuery.product_sub_type,callback:function(e){t.$set(t.listQuery,\"product_sub_type\",e)},expression:\"listQuery.product_sub_type\"}},t._l(t.productSubTypes,function(t){return n(\"el-option\",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),t._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"产品\",clearable:\"\"},model:{value:t.listQuery.product,callback:function(e){t.$set(t.listQuery,\"product\",e)},expression:\"listQuery.product\"}},t._l(t.selectedProducts,function(t){return n(\"el-option\",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),t._v(\" \"),n(\"el-button\",{directives:[{name:\"waves\",rawName:\"v-waves\"}],staticClass:\"filter-item\",staticStyle:{width:\"100px\",\"margin-left\":\"15px\"},attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:t.handleFilter}},[t._v(\"\\n      搜索\\n    \")])],1),t._v(\" \"),n(\"h2\",[t._v(\"库存详情\")]),t._v(\" \"),n(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],key:t.tableKey,staticStyle:{width:\"100%\"},attrs:{data:t.inventories,\"span-method\":t.objectSpanMethod,border:\"\",fit:\"\",\"highlight-current-row\":\"\"}},[n(\"el-table-column\",{attrs:{label:\"产品ID\",prop:\"id\",width:\"100px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[n(\"span\",[t._v(t._s(r.product_id))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品类型\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[n(\"el-tag\",{staticClass:\"tag\",attrs:{color:r.tag_color}},[t._v(t._s(r.product_type))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品细类\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[n(\"el-tag\",{staticClass:\"sub_type_tag\",attrs:{color:r.sub_type_tag_color}},[t._v(t._s(r.product_sub_type))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品名称\",width:\"200px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[n(\"span\",{staticClass:\"link-type\",on:{click:function(e){return t.handleUpdate(r)}}},[t._v(t._s(r.title))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品型号\",width:\"200px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[n(\"span\",[t._v(t._s(r.size))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"剩余数量\",\"min-width\":\"300px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[n(\"span\",{staticClass:\"quantity\",class:{\"low-quantity\":r.quantity<=300}},[t._v(t._s(r.quantity))])]}}])})],1),t._v(\" \"),n(\"pagination\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.total>0,expression:\"total>0\"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{\"update:page\":function(e){return t.$set(t.listQuery,\"page\",e)},\"update:limit\":function(e){return t.$set(t.listQuery,\"limit\",e)},pagination:t.getAllStorage}})],1)},o=[];r._withStripped=!0,n.d(e,\"render\",function(){return r}),n.d(e,\"staticRenderFns\",function(){return o})},Mz3J:function(t,e,n){\"use strict\";var r=n(\"25re\"),o=n(\"6g3Z\"),i=(n(\"VhpY\"),n(\"KHd+\")),c=Object(i.a)(o.a,r.render,r.staticRenderFns,!1,null,\"72233bcd\",null),u=n(\"ZDXL\");u.install(n(\"oCYn\")),u.compatible&&(t.hot.accept(),u.isRecorded(\"72233bcd\")?u.reload(\"72233bcd\",c.options):u.createRecord(\"72233bcd\",c.options),t.hot.accept(\"25re\",function(t){r=n(\"25re\"),u.rerender(\"72233bcd\",{render:r.render,staticRenderFns:r.staticRenderFns})}.bind(this))),c.options.__file=\"src/components/Pagination/index.vue\",e.a=c.exports},RJdx:function(t,e,n){},UE2R:function(t,e,n){\"use strict\";var r=n(\"Y2ow\");n.n(r).a},VhpY:function(t,e,n){\"use strict\";var r=n(\"RJdx\");n.n(r).a},Y2ow:function(t,e,n){},ZySA:function(t,e,n){\"use strict\";n(\"jUE0\");var r=\"@@wavesContext\";function o(t,e){function n(n){var r=Object.assign({},e.value),o=Object.assign({ele:t,type:\"hit\",color:\"rgba(0, 0, 0, 0.15)\"},r),i=o.ele;if(i){i.style.position=\"relative\",i.style.overflow=\"hidden\";var c=i.getBoundingClientRect(),u=i.querySelector(\".waves-ripple\");switch(u?u.className=\"waves-ripple\":((u=document.createElement(\"span\")).className=\"waves-ripple\",u.style.height=u.style.width=Math.max(c.width,c.height)+\"px\",i.appendChild(u)),o.type){case\"center\":u.style.top=c.height/2-u.offsetHeight/2+\"px\",u.style.left=c.width/2-u.offsetWidth/2+\"px\";break;default:u.style.top=(n.pageY-c.top-u.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+\"px\",u.style.left=(n.pageX-c.left-u.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+\"px\"}return u.style.backgroundColor=o.color,u.className=\"waves-ripple z-active\",!1}}return t[r]?t[r].removeHandle=n:t[r]={removeHandle:n},n}var i={bind:function(t,e){t.addEventListener(\"click\",o(t,e),!1)},update:function(t,e){t.removeEventListener(\"click\",t[r].removeHandle,!1),t.addEventListener(\"click\",o(t,e),!1)},unbind:function(t){t.removeEventListener(\"click\",t[r].removeHandle,!1),t[r]=null,delete t[r]}},c=function(t){t.directive(\"waves\",i)};window.Vue&&(window.waves=i,Vue.use(c)),i.install=c;e.a=i},cGyR:function(t,e,n){\"use strict\";n.r(e);var r=n(\"LqgQ\"),o=n(\"3TMG\"),i=(n(\"UE2R\"),n(\"KHd+\")),c=Object(i.a)(o.a,r.render,r.staticRenderFns,!1,null,\"fc98cdce\",null),u=n(\"ZDXL\");u.install(n(\"oCYn\")),u.compatible&&(t.hot.accept(),u.isRecorded(\"fc98cdce\")?u.reload(\"fc98cdce\",c.options):u.createRecord(\"fc98cdce\",c.options),t.hot.accept(\"LqgQ\",function(t){r=n(\"LqgQ\"),u.rerender(\"fc98cdce\",{render:r.render,staticRenderFns:r.staticRenderFns})}.bind(this))),c.options.__file=\"src/views/inventory/storage-check.vue\",e.default=c.exports},jUE0:function(t,e,n){},xMja:function(t,e,n){\"use strict\";var r=n(\"DyJX\");e.a={addProduct:function(t){return new Promise(function(e,n){r.a.post(\"product/add\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProducts:function(t){return new Promise(function(e,n){r.a.post(\"product/get_all_products\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProductCount:function(t){return new Promise(function(e,n){r.a.post(\"product/get_all_products_count\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProductType:function(){return new Promise(function(t,e){r.a.post(\"product/get_all_product_type\").then(function(e){return t(e)}).catch(function(t){return e(t)})})},getAllProductTypeCount:function(){return new Promise(function(t,e){r.a.post(\"product/get_all_product_type_count\").then(function(e){return t(e)}).catch(function(t){return e(t)})})},getProductSubType:function(t){return new Promise(function(e,n){r.a.post(\"product/get_product_sub_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProductSubType:function(t){return new Promise(function(e,n){r.a.post(\"product/get_all_product_sub_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProductSubTypeCount:function(){return new Promise(function(t,e){r.a.post(\"product/get_product_sub_type_count\").then(function(e){return t(e)}).catch(function(t){return e(t)})})},getProductBySubType:function(t){return new Promise(function(e,n){r.a.post(\"product/get_product_by_sub_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},addProductType:function(t){return new Promise(function(e,n){r.a.post(\"product/add_product_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},addProductSubType:function(t){return new Promise(function(e,n){r.a.post(\"product/add_product_sub_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})}}}}]);","extractedComments":[]}