{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{AoWU:function(e,t,n){},\"E+oz\":function(e,t,n){\"use strict\";var a=n(\"AoWU\");n.n(a).a},S4mp:function(e,t,n){\"use strict\";var a=n(\"DyJX\");t.a={getAllResalers:function(e){return new Promise(function(t,n){a.a.post(\"resaler/get_all\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},getResalersCount:function(e){return new Promise(function(t,n){a.a.post(\"resaler/get_count\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},addResaler:function(e){return new Promise(function(t,n){a.a.post(\"resaler/add\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},deleteResaler:function(e){return new Promise(function(t,n){var i={id:e};a.a.post(\"resaler/delete\",i).then(function(e){return t(e)}).catch(function(e){return n(e)})})},getAllResalerRegions:function(e){return new Promise(function(t,n){a.a.post(\"resaler/get_all_regions\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},getResalerRegionsCount:function(){return new Promise(function(e,t){a.a.post(\"resaler/get_region_count\").then(function(t){return e(t)}).catch(function(e){return t(e)})})},addResalerRegion:function(e){return new Promise(function(t,n){a.a.post(\"resaler/add_region\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},addResalerRegionManager:function(e){return new Promise(function(t,n){a.a.post(\"resaler/add_region_manager\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},removeResalerRegionManager:function(e){return new Promise(function(t,n){a.a.post(\"resaler/remove_region_manager\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},getAllResalerAreas:function(e){return new Promise(function(t,n){a.a.post(\"resaler/get_all_areas\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},getResalerAreasCount:function(){return new Promise(function(e,t){a.a.post(\"resaler/get_area_count\").then(function(t){return e(t)}).catch(function(e){return t(e)})})},addResalerArea:function(e){return new Promise(function(t,n){a.a.post(\"resaler/add_area\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},addResalerAreaManager:function(e){return new Promise(function(t,n){a.a.post(\"resaler/add_area_manager\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},removeResalerAreaManager:function(e){return new Promise(function(t,n){a.a.post(\"resaler/remove_area_manager\",e).then(function(e){return t(e)}).catch(function(e){return n(e)})})},getResalerTypes:function(){return new Promise(function(e,t){a.a.post(\"resaler/get_all_types\").then(function(t){return e(t)}).catch(function(e){return t(e)})})}}},ZySA:function(e,t,n){\"use strict\";n(\"jUE0\");var a=\"@@wavesContext\";function i(e,t){function n(n){var a=Object.assign({},t.value),i=Object.assign({ele:e,type:\"hit\",color:\"rgba(0, 0, 0, 0.15)\"},a),r=i.ele;if(r){r.style.position=\"relative\",r.style.overflow=\"hidden\";var l=r.getBoundingClientRect(),s=r.querySelector(\".waves-ripple\");switch(s?s.className=\"waves-ripple\":((s=document.createElement(\"span\")).className=\"waves-ripple\",s.style.height=s.style.width=Math.max(l.width,l.height)+\"px\",r.appendChild(s)),i.type){case\"center\":s.style.top=l.height/2-s.offsetHeight/2+\"px\",s.style.left=l.width/2-s.offsetWidth/2+\"px\";break;default:s.style.top=(n.pageY-l.top-s.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+\"px\",s.style.left=(n.pageX-l.left-s.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+\"px\"}return s.style.backgroundColor=i.color,s.className=\"waves-ripple z-active\",!1}}return e[a]?e[a].removeHandle=n:e[a]={removeHandle:n},n}var r={bind:function(e,t){e.addEventListener(\"click\",i(e,t),!1)},update:function(e,t){e.removeEventListener(\"click\",e[a].removeHandle,!1),e.addEventListener(\"click\",i(e,t),!1)},unbind:function(e){e.removeEventListener(\"click\",e[a].removeHandle,!1),e[a]=null,delete e[a]}},l=function(e){e.directive(\"waves\",r)};window.Vue&&(window.waves=r,Vue.use(l)),r.install=l;t.a=r},dIBz:function(e,t,n){\"use strict\";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"app-container\"},[n(\"div\",{staticClass:\"filter-container\"},[n(\"h2\",[e._v(\"筛选结果\")]),e._v(\" \"),n(\"el-date-picker\",{staticClass:\"filter-item\",staticStyle:{\"margin-left\":\"15px\"},attrs:{type:\"monthrange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始月份\",\"end-placeholder\":\"结束月份\"},model:{value:e.listQuery.date,callback:function(t){e.$set(e.listQuery,\"date\",t)},expression:\"listQuery.date\"}}),e._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"分销大区\",clearable:\"\"},on:{change:function(t){return e.getAreas(e.listQuery.region_id)}},model:{value:e.listQuery.region_id,callback:function(t){e.$set(e.listQuery,\"region_id\",t)},expression:\"listQuery.region_id\"}},e._l(e.resalerRegions,function(e){return n(\"el-option\",{key:e.id,attrs:{label:e.title,value:e.id}})}),1),e._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"分销地区\",clearable:\"\"},on:{change:function(t){return e.getResalers(e.listQuery.resaler_region_id,e.listQuery.area_id)}},model:{value:e.listQuery.area_id,callback:function(t){e.$set(e.listQuery,\"area_id\",t)},expression:\"listQuery.area_id\"}},e._l(e.resalerAreas,function(e){return n(\"el-option\",{key:e.id,attrs:{label:e.title,value:e.id}})}),1),e._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"分销渠道\",clearable:\"\"},model:{value:e.listQuery.resaler_id,callback:function(t){e.$set(e.listQuery,\"resaler_id\",t)},expression:\"listQuery.resaler_id\"}},e._l(e.resalers,function(e){return n(\"el-option\",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"地区经理\",clearable:\"\"},model:{value:e.listQuery.area_manager_atm,callback:function(t){e.$set(e.listQuery,\"area_manager_atm\",t)},expression:\"listQuery.area_manager_atm\"}},e._l(e.areaManager,function(e){return n(\"el-option\",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"大区经理\",clearable:\"\"},model:{value:e.listQuery.region_manager_atm,callback:function(t){e.$set(e.listQuery,\"region_manager_atm\",t)},expression:\"listQuery.region_manager_atm\"}},e._l(e.regionManager,function(e){return n(\"el-option\",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(\" \"),n(\"el-button\",{directives:[{name:\"waves\",rawName:\"v-waves\"}],staticClass:\"filter-item\",staticStyle:{width:\"100px\",\"margin-left\":\"15px\"},attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:e.handleFilter}},[e._v(\"\\n      搜索\\n    \")])],1),e._v(\" \"),n(\"el-dialog\",{attrs:{title:\"价格修改申请\",visible:e.priceChangeDialogFormVisible,width:\"80%\"},on:{\"update:visible\":function(t){e.priceChangeDialogFormVisible=t}}},[n(\"el-form\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],ref:\"dataForm\",staticStyle:{\"margin-left\":\"20px\"},attrs:{model:e.temp,\"label-position\":\"left\",\"label-width\":\"10px\"}},[n(\"div\",[n(\"div\",{staticStyle:{display:\"inline-block\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 申请人 \")]),e._v(\" \"),n(\"el-input\",{staticClass:\"filter-item inventory-in-input-extra\",attrs:{placeholder:\"申请人\",disabled:!0},model:{value:this.name,callback:function(t){e.$set(this,\"name\",t)},expression:\"this.name\"}})],1),e._v(\" \"),n(\"div\",{staticStyle:{display:\"inline-block\",\"margin-left\":\"15px\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 订单编号 \")]),e._v(\" \"),n(\"el-input\",{staticClass:\"filter-item inventory-in-input-extra\",attrs:{placeholder:\"订单编号\",disabled:!0},model:{value:e.temp.sales_id,callback:function(t){e.$set(e.temp,\"sales_id\",t)},expression:\"temp.sales_id\"}})],1),e._v(\" \"),n(\"div\",{staticStyle:{display:\"inline-block\",\"margin-left\":\"15px\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 当前订单总价 \")]),e._v(\" \"),n(\"el-input\",{staticClass:\"filter-item inventory-in-input-line\",attrs:{placeholder:\"当前订单总价\",disabled:!0},model:{value:e.temp.current_price,callback:function(t){e.$set(e.temp,\"current_price\",t)},expression:\"temp.current_price\"}})],1)]),e._v(\" \"),n(\"div\",{staticStyle:{\"margin-top\":\"20px\"}},[n(\"div\",{staticStyle:{display:\"block\"}},[n(\"div\",{staticStyle:{display:\"inline-block\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 修改订单总价 \")]),e._v(\" \"),n(\"el-input\",{staticClass:\"filter-item inventory-in-input-extra\",attrs:{placeholder:\"修改订单总价\"},model:{value:e.temp.new_price,callback:function(t){e.$set(e.temp,\"new_price\",t)},expression:\"temp.new_price\"}})],1)]),e._v(\" \"),n(\"div\",{staticStyle:{display:\"block\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 修改原因 \")]),e._v(\" \"),n(\"el-input\",{attrs:{type:\"textarea\",placeholder:\"备注\"},model:{value:e.temp.note,callback:function(t){e.$set(e.temp,\"note\",t)},expression:\"temp.note\"}})],1)])]),e._v(\" \"),n(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[n(\"el-button\",{on:{click:function(t){return e.dismissPriceChangeDialog()}}},[e._v(\"\\n        取消\\n      \")]),e._v(\" \"),n(\"el-button\",{attrs:{type:\"primary\",loading:e.listLoading},on:{click:function(t){return e.confirmPriceChangeRequest(1)}}},[e._v(\"\\n        提交价格修改需求\\n      \")])],1)],1),e._v(\" \"),n(\"el-dialog\",{attrs:{title:\"价格修改申请\",visible:e.reviewPriceChangeDialogFormVisible,width:\"80%\"},on:{\"update:visible\":function(t){e.reviewPriceChangeDialogFormVisible=t}}},[n(\"el-form\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],ref:\"dataForm\",staticStyle:{\"margin-left\":\"20px\"},attrs:{model:this.priceChangeData,\"label-position\":\"left\",\"label-width\":\"10px\"}},[n(\"div\",{staticStyle:{display:\"block\"}},[n(\"div\",{staticStyle:{display:\"inline-block\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 订单编号 \")]),e._v(\" \"),n(\"el-input\",{staticClass:\"filter-item inventory-in-input-extra\",attrs:{placeholder:\"订单编号\",disabled:!0},model:{value:this.priceChangeData.sales_id,callback:function(t){e.$set(this.priceChangeData,\"sales_id\",t)},expression:\"this.priceChangeData.sales_id\"}})],1),e._v(\" \"),n(\"div\",{staticStyle:{display:\"inline-block\",\"margin-left\":\"15px\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 申请人 \")]),e._v(\" \"),n(\"el-input\",{staticClass:\"filter-item inventory-in-input-extra\",attrs:{placeholder:\"申请人\",disabled:!0},model:{value:this.priceChangeData.requested_by,callback:function(t){e.$set(this.priceChangeData,\"requested_by\",t)},expression:\"this.priceChangeData.requested_by\"}})],1)]),e._v(\" \"),n(\"div\",{staticStyle:{display:\"block\"}},[n(\"div\",{staticStyle:{display:\"inline-block\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 当前订单总价 \")]),e._v(\" \"),n(\"el-input\",{staticClass:\"filter-item inventory-in-input-line\",attrs:{placeholder:\"当前订单总价\",disabled:!0},model:{value:this.priceChangeData.current_price,callback:function(t){e.$set(this.priceChangeData,\"current_price\",t)},expression:\"this.priceChangeData.current_price\"}})],1),e._v(\" \"),n(\"div\",{staticStyle:{display:\"inline-block\",\"margin-left\":\"15px\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 修改后价格 \")]),e._v(\" \"),n(\"el-input\",{staticClass:\"filter-item inventory-in-input-extra\",attrs:{placeholder:\"修改订单总价\",disabled:!0},model:{value:this.priceChangeData.new_price,callback:function(t){e.$set(this.priceChangeData,\"new_price\",t)},expression:\"this.priceChangeData.new_price\"}})],1)]),e._v(\" \"),n(\"div\",{staticStyle:{display:\"block\"}},[n(\"h3\",{staticStyle:{display:\"inline-block\"}},[e._v(\" 修改原因 \")]),e._v(\" \"),n(\"el-input\",{attrs:{type:\"textarea\",placeholder:\"备注\",disabled:!0},model:{value:this.priceChangeData.price_change_note,callback:function(t){e.$set(this.priceChangeData,\"price_change_note\",t)},expression:\"this.priceChangeData.price_change_note\"}})],1)]),e._v(\" \"),n(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[n(\"el-button\",{on:{click:function(t){return e.dismissPriceChangeDialog()}}},[e._v(\"\\n        关闭页面\\n      \")]),e._v(\" \"),5===e.role||1===e.role?n(\"el-button\",{attrs:{type:\"primary\",loading:e.listLoading},on:{click:function(t){return e.confirmPriceChangeRequest(2)}}},[e._v(\"\\n        确认价格修改\\n      \")]):e._e(),e._v(\" \"),e.id===this.priceChangeData.added_by?n(\"el-button\",{attrs:{type:\"danger\",plain:\"\"},on:{click:function(t){return e.cancelPriceChanegRequest()}}},[e._v(\"取消申请\")]):e._e()],1)],1),e._v(\" \"),n(\"h2\",[e._v(\"需要审核的订单\")]),e._v(\" \"),n(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],key:e.tableKey,staticStyle:{width:\"100%\"},attrs:{data:e.sales,\"span-method\":e.objectSpanMethod,border:\"\",fit:\"\",\"row-class-name\":e.tableRowClassName}},[n(\"el-table-column\",{attrs:{label:\"订单ID\",prop:\"id\",width:\"80px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.id))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"分销渠道\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.name))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"送货地址\",prop:\"sales_type\",width:\"200px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.address))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"联系方式\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.contact)+\" \"+e._s(a.phone))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"所属地区\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.area_title))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"订单归属地区经理\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.area_manager_atm_name))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"所属大区\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.region_title))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"订单归属大区经理\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.region_manager_atm_name))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"销售时间\",prop:\"sales_type\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(e.moment(a.date).format(\"YYYY-MM-DD\")))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品类型\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"el-tag\",{staticClass:\"tag\",attrs:{color:a.tag_color}},[e._v(e._s(a.product_type))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品细类\",width:\"140px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"el-tag\",{staticClass:\"sub_type_tag\",attrs:{color:a.sub_type_tag_color}},[e._v(e._s(a.product_sub_type))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品名称\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",{staticClass:\"link-type\",on:{click:function(t){return e.handleUpdate(a)}}},[e._v(e._s(a.product_title))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品型号\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.size))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"销售数量\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.quantity))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"赠送数量\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.promotion_quantity))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"出库总量\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.quantity+a.promotion_quantity))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"订单销售总价\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.order_total_price))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"订单添加人\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.added_by_name))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"支付公司\",width:\"200px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.payment_company_title))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"支付渠道\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.payment_channel_title))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"全额付款\",width:\"100px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"el-tag\",{staticClass:\"tag\",attrs:{color:0===a.fully_paid?\"#e74c3c\":\"#2ecc71\"}},[e._v(e._s(1===a.fully_paid?\"是\":\"否\"))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"云仓订单编号\",width:\"200px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.deliver_tracking_code))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"备注\",width:\"250px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[n(\"span\",[e._v(e._s(a.note))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"审核订单\",width:\"500px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[a.new_price&&0!==a.new_price?n(\"div\",[n(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:function(t){return e.showPriceChangeRequest(a)}}},[e._v(\"改价申请中..\")])],1):n(\"div\",[e.id===a.added_by&&0===a.fully_paid?n(\"el-button\",{attrs:{type:\"danger\",plain:\"\"},on:{click:function(t){return e.deleteOrder(a)}}},[e._v(\"取消订单\")]):e._e(),e._v(\" \"),e.id===a.added_by&&0===a.fully_paid?n(\"el-button\",{attrs:{type:\"warning\",plain:\"\"},on:{click:function(t){return e.priceChangeRequest(a)}}},[e._v(\"申请改价\")]):e._e(),e._v(\" \"),7===e.role||5===e.role||1===e.role&&0===a.fully_paid?n(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:function(t){return e.updateSalesPaidStuats(a)}}},[e._v(\"确认收款\")]):e._e(),e._v(\" \"),7===e.role||1===e.role&&1===a.fully_paid?n(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:function(t){return e.updateDeliveryCode(a)}}},[e._v(\"发货\")]):e._e()],1)]}}])})],1),e._v(\" \"),n(\"pagination\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.total>0,expression:\"total>0\"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{\"update:page\":function(t){return e.$set(e.listQuery,\"page\",t)},\"update:limit\":function(t){return e.$set(e.listQuery,\"limit\",t)},pagination:e.getAllSales}})],1)};a._withStripped=!0;n(\"rGqo\");var i=n(\"23J+\"),r=n(\"xUCC\"),l=n(\"S4mp\"),s=n(\"wk8/\"),o=n(\"ZySA\"),c=n(\"Mz3J\"),u=n(\"L2JU\"),d=n(\"wd/R\"),p=n.n(d),f={name:\"ComplexTable\",components:{Pagination:c.a},directives:{waves:o.a},filters:{},data:function(){return{tableKey:0,sales:null,total:0,listLoading:!0,products:[],resalers:[],resalerRegions:[],resalerAreas:[],areaManager:[],regionManager:[],listQuery:{page:1,limit:10,product_type:void 0,product_sub_type:void 0,area_id:void 0,region_id:void 0,resaler_id:void 0,area_manager_atm:void 0,region_manager_atm:void 0},temp:{sales_id:void 0,current_price:void 0,new_price:void 0,note:void 0},priceChangeData:{sales_id:void 0,new_price:void 0,requested_by:void 0,price_change_note:void 0},priceChangeDialogFormVisible:!1,reviewPriceChangeDialogFormVisible:!1,formType:0,rowSpans:null}},created:function(){},computed:Object(i.a)({},Object(u.b)([\"id\",\"role\",\"name\"])),beforeRouteEnter:function(e,t,n){n(function(e){e.getAllSales(),e.getSalesCount(),e.getResalers(),e.getAreas(),e.getRegions(),e.getSalesAreaManager(),e.getSalesRegionManager(),n()})},methods:{calculateRowSpan:function(){var e=[],t=0;this.sales.forEach(function(n){var a=!1;if(e.forEach(function(e){e.id===n.id&&(a=!0,e.end++,e.rowSpan++,t=e.start+e.rowSpan)}),!a){var i={id:n.id,start:t,end:t+1,rowSpan:1};t++,e.push(i)}}),this.rowSpans=e},getAllSales:function(){var e=this;this.listLoading=!0,this.listQuery.date&&this.listQuery.date.length>1&&(this.listQuery.start_date=p()(this.listQuery.date[0]).format(\"YYYY-MM-DD\"),this.listQuery.end_date=p()(this.listQuery.date[1]).format(\"YYYY-MM-DD\")),r.a.getAllInReviewSales(this.listQuery).then(function(t){e.sales=t,e.listLoading=!1,e.calculateRowSpan()}).catch(function(t){e.$message({message:\"getAllSales 读取库存失败，请联系徐神检查\",type:\"error\"}),e.listLoading=!1})},getSalesCount:function(){var e=this;r.a.getAllInReviewSalesCount(this.listQuery).then(function(t){e.total=t.total})},getAreas:function(e){var t=this;l.a.getAllResalerAreas({region_id:e,page:1,limit:1e4}).then(function(e){t.resalerAreas=e}).catch(function(e){})},getRegions:function(){var e=this;l.a.getAllResalerRegions({page:1,limit:1e4}).then(function(t){e.resalerRegions=t}).catch(function(e){})},getSalesAreaManager:function(){var e=this;s.a.getAccounts({role:[4,5]}).then(function(t){e.areaManager=t})},getSalesRegionManager:function(){var e=this;s.a.getAccounts({role:[5]}).then(function(t){e.regionManager=t})},getResalers:function(e,t){var n=this;l.a.getAllResalers({region_id:e,area_id:t}).then(function(e){n.resalers=e})},tableRowClassName:function(e){e.row;for(var t=e.rowIndex,n=0,a=0;a<this.rowSpans.length;a++){var i=this.rowSpans[a];t>=i.start&&t<i.end&&(n=a)}return n%2==0?\"blue-row\":\"pink-row\"},objectSpanMethod:function(e){e.row,e.column;var t=e.rowIndex,n=e.columnIndex;if(n<10||n>=16&&n<=23){var a={rowspan:0,colspan:0};return this.rowSpans.forEach(function(e){t>=e.start&&t<e.end&&(t-e.start)%e.rowSpan==0&&(a={rowspan:e.rowSpan,colspan:1})}),a}},handleFilter:function(){this.listQuery.page=1,this.getAllSales(),this.getSalesCount()},clearFullyPaid:function(){this.listQuery.fully_paid=void 0},updateSalesPaidStuats:function(e){var t=this;this.$confirm(\"确定订单编号\"+e.id+\"已经全额付款 >>总额：\"+e.order_total_price+\"<<?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.sendUpdateSalesPaidRequest(e.id)}).catch(function(){})},sendUpdateSalesPaidRequest:function(e){var t=this;this.listLoading=!0,r.a.updateSalesPaidStatus({sales_id:e}).then(function(e){t.listLoading=!1,t.$alert(\"订单修改成功\",\"成功\",{confirmButtonText:\"确定\",callback:function(e){t.page=1,t.getAllSales(),t.getSalesCount()}})}).catch(function(e){t.$message({message:\"销售订单修改失败，请联系徐神检查\",type:\"error\"}),t.listLoading=!1})},updateDeliveryCode:function(e){var t=this;this.$prompt(\"请输入云仓发货编号\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\"}).then(function(n){var a=n.value;t.$confirm(\"确定发货编号为\"+a,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.sendUpdateSalesDeliveryRequest(e.id,e.inventory_id,a)}).catch(function(){})}).catch(function(){t.$message({type:\"info\",message:\"取消输入\"})})},sendUpdateSalesDeliveryRequest:function(e,t,n){var a=this;this.listLoading=!0;var i={sales_id:e,delivery_code:n,inventory_id:t};r.a.updateSalesDeliveryCode(i).then(function(e){a.listLoading=!1,a.$alert(\"订单修改成功\",\"成功\",{confirmButtonText:\"确定\",callback:function(e){a.page=1,a.getAllSales(),a.getSalesCount()}})}).catch(function(e){a.$message({message:\"销售订单修改失败，请联系徐神检查\",type:\"error\"}),a.listLoading=!1})},deleteOrder:function(e){var t=this;this.$confirm(\"是否确定删除本订单，删除后将无法恢复\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.sendDeleteOrderRequest(e.id,e.inventory_id)}).catch(function(){})},sendDeleteOrderRequest:function(e,t){var n=this;this.listLoading=!0,r.a.deleteSales({id:e,inventory_id:t}).then(function(e){n.listLoading=!1,n.$alert(\"删除成功\",\"成功\",{confirmButtonText:\"确定\",callback:function(e){n.page=1,n.getAllSales(),n.getSalesCount()}})}).catch(function(e){n.$message({message:\"订单修改失败，请联系徐神检查\",type:\"error\"}),n.listLoading=!1})},priceChangeRequest:function(e){this.priceChangeDialogFormVisible=!0,this.temp.sales_id=e.id,this.temp.current_price=e.order_total_price},dismissPriceChangeDialog:function(){this.priceChangeDialogFormVisible=!1,this.reviewPriceChangeDialogFormVisible=!1,this.priceChangeData={sales_id:void 0,new_price:void 0,requested_by:void 0,price_change_note:void 0},this.temp={sales_id:void 0,current_price:void 0,new_price:void 0,note:void 0}},confirmPriceChangeRequest:function(e){var t=this;1===e?this.temp.new_price?this.temp.note?this.$confirm(\"确定要申请价格调整，新价格为：\"+this.temp.new_price,{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.sendPriceChangeRequestRequest()}).catch(function(){}):this.$message({message:\"必须填写申请价格调整的理由\",type:\"error\"}):this.$message({message:\"必须填写新价格\",type:\"error\"}):2===e&&this.$confirm(\"确定价格修改为：\"+this.priceChangeData.new_price,{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.sendPriceChangeConfirmationRequest()}).catch(function(){})},sendPriceChangeRequestRequest:function(){var e=this;this.listLoading=!0,r.a.requestOrderPriceChange(this.temp).then(function(t){e.listLoading=!1,e.$alert(\"申请成功，请联系Mint确认\",\"成功\",{confirmButtonText:\"确定\",callback:function(t){e.page=1,e.dismissPriceChangeDialog(),e.getAllSales(),e.getSalesCount()}})}).catch(function(t){e.$message({message:\"订单修改失败，请联系徐神检查\",type:\"error\"}),e.listLoading=!1})},sendPriceChangeConfirmationRequest:function(){var e=this;this.listLoading=!0,r.a.confirmOrderPriceChange(this.priceChangeData).then(function(t){e.listLoading=!1,e.$alert(\"价格修改成功\",\"成功\",{confirmButtonText:\"确定\",callback:function(t){e.page=1,e.dismissPriceChangeDialog(),e.getAllSales(),e.getSalesCount()}})}).catch(function(t){e.$message({message:\"订单修改失败，请联系徐神检查\",type:\"error\"}),e.listLoading=!1})},showPriceChangeRequest:function(e){this.priceChangeData={sales_id:e.id,new_price:e.new_price,requested_by:e.added_by_name,added_by:e.added_by,price_change_note:e.price_change_note,current_price:e.order_total_price},this.reviewPriceChangeDialogFormVisible=!0},cancelPriceChanegRequest:function(){var e=this;this.$confirm(\"确定要取消本价格申请吗？\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){e.sendPriceChangeConfirmationRequest()}).catch(function(){})},sendCancelPriceChanegRequest:function(){var e=this;this.listLoading=!0,r.a.cancelOrderPriceChange({sales_id:this.priceChangeData.sales_id}).then(function(t){e.listLoading=!1,e.$alert(\"申请已取消\",\"成功\",{confirmButtonText:\"确定\",callback:function(t){e.page=1,e.dismissPriceChangeDialog(),e.getAllSales(),e.getSalesCount()}})}).catch(function(t){e.$message({message:\"订单修改失败，请联系徐神检查\",type:\"error\"}),e.listLoading=!1})}}},_=(n(\"E+oz\"),n(\"KHd+\")),g=Object(_.a)(f,a,[],!1,null,null,null);g.options.__file=\"src/views/sales/in-review-order.vue\";t.default=g.exports},jUE0:function(e,t,n){}}]);","extractedComments":[]}