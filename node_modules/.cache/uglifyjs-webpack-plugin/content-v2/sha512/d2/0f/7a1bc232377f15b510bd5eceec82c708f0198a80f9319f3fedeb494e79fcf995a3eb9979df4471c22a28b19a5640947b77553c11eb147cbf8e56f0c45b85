{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{IQJY:function(e,t,a){\"use strict\";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.role?a(\"div\",{staticClass:\"app-container\"},[a(\"div\",{staticClass:\"filter-container\"},[a(\"h2\",{staticStyle:{display:\"inline-block\"}},[e._v(\"选择月份\")]),e._v(\" \"),a(\"el-date-picker\",{staticClass:\"filter-item\",staticStyle:{\"margin-left\":\"15px\"},attrs:{type:\"monthrange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始月份\",\"end-placeholder\":\"结束月份\"},on:{change:e.handleFilter},model:{value:e.listQuery.date,callback:function(t){e.$set(e.listQuery,\"date\",t)},expression:\"listQuery.date\"}}),e._v(\" \"),a(\"el-button\",{directives:[{name:\"waves\",rawName:\"v-waves\"}],staticClass:\"filter-item\",staticStyle:{width:\"100px\",\"margin-left\":\"15px\"},attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:e.handleFilter}},[e._v(\"\\n      搜索\\n    \")])],1),e._v(\" \"),a(\"div\",[a(\"h2\",{staticStyle:{display:\"inline-block\"}},[e._v(e._s(e.moment(this.listQuery.date[0]).format(\"YYYY-MM-01\"))+\" 至 \"+e._s(e.moment(this.listQuery.date[1]).format(\"YYYY-MM-01\"))+\" \")]),e._v(\" \"),a(\"h2\",{staticStyle:{color:\"red\",display:\"inline-block\"}},[e._v(\"销售总额 1919192.2\")])]),e._v(\" \"),6===e.role||1===e.role?a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],key:e.tableKey,staticStyle:{width:\"100%\"},attrs:{data:e.sales,\"span-method\":e.objectSpanMethod,border:\"\",fit:\"\"}},[a(\"el-table-column\",{attrs:{label:\"分销大区\",prop:\"id\",width:\"80px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var l=t.row;return[a(\"span\",[e._v(e._s(l.region_title))])]}}],null,!1,682204387)}),e._v(\" \"),a(\"el-table-column\",{attrs:{label:\"大区经理\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var l=t.row;return[a(\"span\",[e._v(e._s(l.region_manager_name))])]}}],null,!1,1302318472)}),e._v(\" \"),a(\"el-table-column\",{attrs:{label:\"大区本月总销售\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var l=t.row;return[a(\"span\",[e._v(e._s(l.region_total_sales?l.region_total_sales:0))])]}}],null,!1,843718805)}),e._v(\" \"),a(\"el-table-column\",{attrs:{label:\"销售地区\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var l=t.row;return[a(\"span\",[e._v(e._s(l.area_title))])]}}],null,!1,4199390380)}),e._v(\" \"),a(\"el-table-column\",{attrs:{label:\"地区经理\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var l=t.row;return[a(\"span\",[e._v(e._s(l.area_manager_name))])]}}],null,!1,331108551)}),e._v(\" \"),a(\"el-table-column\",{attrs:{label:\"地区本月总销售\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var l=t.row;return[a(\"span\",[e._v(e._s(l.area_total_sales?l.area_total_sales:0))])]}}],null,!1,176918453)}),e._v(\" \"),a(\"el-table-column\",{attrs:{label:\"产品分类销售\",prop:\"sales_type\",width:\"350px\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var l=t.row;return[a(\"el-popover\",{attrs:{placement:\"right\",width:\"600\",trigger:\"click\"}},[a(\"el-table\",{attrs:{data:l.products_sales}},[a(\"el-table-column\",{attrs:{width:\"150\",property:\"product_type_id\",label:\"产品分类编号\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{width:\"250\",property:\"product_type_title\",label:\"产品分类名称\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{width:\"200\",property:\"total_product_sales\",label:\"产品分类销售额\"}})],1),e._v(\" \"),a(\"el-button\",{attrs:{slot:\"reference\"},slot:\"reference\"},[e._v(\"查看分类销售额\")])],1)]}}],null,!1,2196270900)})],1):e._e()],1):a(\"div\",{staticClass:\"app-container\"},[a(\"h2\",[e._v(\" 并没有权限查看 \")]),e._v(\" \"),a(\"h2\",[e._v(\" Please Get out! \")])])};l._withStripped=!0;a(\"rGqo\");var n=a(\"23J+\"),r=a(\"xUCC\"),o=a(\"ZySA\"),i=(a(\"7Qib\"),a(\"Mz3J\")),s=a(\"L2JU\"),c=a(\"wd/R\"),d=a.n(c),p={name:\"ComplexTable\",components:{Pagination:i.a},directives:{waves:o.a},filters:{},data:function(){return{tableKey:0,listLoading:!1,sales:null,listQuery:{page:1,limit:100,date:[]},rowSpans:null}},created:function(){this.listQuery.date=[new Date,d()().add(1,\"months\")]},computed:Object(n.a)({},Object(s.b)([\"id\",\"role\"])),beforeRouteEnter:function(e,t,a){a(function(e){e.getReport(),a()})},methods:{calculateRowSpan:function(){var e=[],t=0;this.sales.forEach(function(a){var l=!1;if(e.forEach(function(e){e.region_id===a.region_id&&(l=!0,e.end++,e.rowSpan++,t=e.start+e.rowSpan)}),!l){var n={region_id:a.region_id,start:t,end:t+1,rowSpan:1};t++,e.push(n)}}),this.rowSpans=e},getReport:function(){var e=this;1!==this.role&&6!==this.role||(this.listLoading=!0,this.listQuery.date&&this.listQuery.date.length>1&&(this.listQuery.start_date=d()(this.listQuery.date[0]).format(\"YYYY-MM-01\"),this.listQuery.end_date=d()(this.listQuery.date[1]).format(\"YYYY-MM-01\")),r.a.getGeneralSalesReport(this.listQuery).then(function(t){var a=[];e.listLoading=!1,t.forEach(function(e){var t=!1;if(a.forEach(function(a){if(a.area_id===e.area_id){var l={product_type_id:e.product_type_id,product_type_title:e.product_type_title,total_product_sales:e.total_product_sales};a.products_sales.push(l),t=!0}}),!t){var l={region_id:e.region_id,region_title:e.region_title,region_manager_id:e.region_manager_id,region_manager_name:e.region_manager_name,area_id:e.area_id,area_title:e.area_title,area_manager_name:e.area_manager_name,area_total_sales:e.area_total_sales,region_total_sales:e.region_total_sales,products_sales:[{product_type_id:e.product_type_id,product_type_title:e.product_type_title,total_product_sales:e.total_product_sales}]};a.push(l)}}),e.sales=a,e.calculateRowSpan()}).catch(function(t){e.$message({message:\"getAllSales 读取库存失败，请联系徐神检查\",type:\"error\"}),e.listLoading=!1}))},objectSpanMethod:function(e){e.row,e.column;var t=e.rowIndex;if(e.columnIndex<3){var a={rowspan:0,colspan:0};return this.rowSpans.forEach(function(e){t>=e.start&&t<e.end&&(t-e.start)%e.rowSpan==0&&(a={rowspan:e.rowSpan,colspan:1})}),a}},handleFilter:function(){this.getReport()}}},u=(a(\"wU/X\"),a(\"KHd+\")),_=Object(u.a)(p,l,[],!1,null,\"bc60a360\",null);_.options.__file=\"src/views/report/detail-sales-report.vue\";t.default=_.exports},SOeX:function(e,t,a){},ZySA:function(e,t,a){\"use strict\";a(\"jUE0\");var l=\"@@wavesContext\";function n(e,t){function a(a){var l=Object.assign({},t.value),n=Object.assign({ele:e,type:\"hit\",color:\"rgba(0, 0, 0, 0.15)\"},l),r=n.ele;if(r){r.style.position=\"relative\",r.style.overflow=\"hidden\";var o=r.getBoundingClientRect(),i=r.querySelector(\".waves-ripple\");switch(i?i.className=\"waves-ripple\":((i=document.createElement(\"span\")).className=\"waves-ripple\",i.style.height=i.style.width=Math.max(o.width,o.height)+\"px\",r.appendChild(i)),n.type){case\"center\":i.style.top=o.height/2-i.offsetHeight/2+\"px\",i.style.left=o.width/2-i.offsetWidth/2+\"px\";break;default:i.style.top=(a.pageY-o.top-i.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+\"px\",i.style.left=(a.pageX-o.left-i.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+\"px\"}return i.style.backgroundColor=n.color,i.className=\"waves-ripple z-active\",!1}}return e[l]?e[l].removeHandle=a:e[l]={removeHandle:a},a}var r={bind:function(e,t){e.addEventListener(\"click\",n(e,t),!1)},update:function(e,t){e.removeEventListener(\"click\",e[l].removeHandle,!1),e.addEventListener(\"click\",n(e,t),!1)},unbind:function(e){e.removeEventListener(\"click\",e[l].removeHandle,!1),e[l]=null,delete e[l]}},o=function(e){e.directive(\"waves\",r)};window.Vue&&(window.waves=r,Vue.use(o)),r.install=o;t.a=r},jUE0:function(e,t,a){},\"wU/X\":function(e,t,a){\"use strict\";var l=a(\"SOeX\");a.n(l).a}}]);","extractedComments":[]}