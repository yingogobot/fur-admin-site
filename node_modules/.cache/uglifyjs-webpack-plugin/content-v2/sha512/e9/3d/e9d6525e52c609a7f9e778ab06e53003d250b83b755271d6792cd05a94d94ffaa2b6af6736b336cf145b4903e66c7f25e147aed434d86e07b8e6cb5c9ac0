{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{\"9R6f\":function(t,e,a){\"use strict\";var r=a(\"FKJx\");a.n(r).a},FKJx:function(t,e,a){},P6la:function(t,e,a){\"use strict\";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return 1===t.role?a(\"div\",{staticClass:\"app-container\"},[a(\"div\",{staticClass:\"filter-container\"},[a(\"h2\",{staticStyle:{display:\"inline-block\"}},[t._v(\"选择月份\")]),t._v(\" \"),a(\"el-date-picker\",{staticClass:\"filter-item\",staticStyle:{\"margin-left\":\"15px\"},attrs:{type:\"monthrange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始月份\",\"end-placeholder\":\"结束月份\"},on:{change:t.handleFilter},model:{value:t.listQuery.date,callback:function(e){t.$set(t.listQuery,\"date\",e)},expression:\"listQuery.date\"}}),t._v(\" \"),a(\"el-button\",{directives:[{name:\"waves\",rawName:\"v-waves\"}],staticClass:\"filter-item\",staticStyle:{width:\"100px\",\"margin-left\":\"15px\"},attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:t.handleFilter}},[t._v(\"\\n      搜索\\n    \")])],1),t._v(\" \"),a(\"div\",[a(\"h2\",{staticStyle:{display:\"inline-block\"}},[t._v(t._s(t.moment(this.listQuery.date[0]).format(\"YYYY-MM-01\"))+\" 至 \"+t._s(t.moment(this.listQuery.date[1]).format(\"YYYY-MM-01\"))+\" \")]),t._v(\" \"),a(\"h2\",{staticStyle:{color:\"red\",display:\"inline-block\"}},[t._v(\"销售总额 1919192.2\")])]),t._v(\" \"),6===t.role||1===t.role?a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],key:t.tableKey,staticStyle:{width:\"100%\"},attrs:{data:t.sales,\"span-method\":t.objectSpanMethod,border:\"\",fit:\"\"}},[a(\"el-table-column\",{attrs:{label:\"分销大区\",prop:\"id\",width:\"80px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[a(\"span\",[t._v(t._s(r.region_title))])]}}],null,!1,682204387)}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"大区经理\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[a(\"span\",[t._v(t._s(r.region_manager_name))])]}}],null,!1,1302318472)}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"大区本月总销售\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[a(\"span\",[t._v(t._s(r.region_total_sales?r.region_total_sales:0))])]}}],null,!1,843718805)}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"销售地区\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[a(\"span\",[t._v(t._s(r.area_title))])]}}],null,!1,4199390380)}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"地区经理\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[a(\"span\",[t._v(t._s(r.area_manager_name))])]}}],null,!1,331108551)}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"地区本月总销售\",prop:\"sales_type\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[a(\"span\",[t._v(t._s(r.area_total_sales?r.area_total_sales:0))])]}}],null,!1,176918453)}),t._v(\" \"),a(\"el-table-column\",{attrs:{label:\"产品分类销售\",prop:\"sales_type\",width:\"350px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var r=e.row;return[a(\"el-popover\",{attrs:{placement:\"right\",width:\"600\",trigger:\"click\"}},[a(\"el-table\",{attrs:{data:r.products_sales}},[a(\"el-table-column\",{attrs:{width:\"150\",property:\"product_type_id\",label:\"产品分类编号\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{width:\"250\",property:\"product_type_title\",label:\"产品分类名称\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{width:\"200\",property:\"total_product_sales\",label:\"产品分类销售额\"}})],1),t._v(\" \"),a(\"el-button\",{attrs:{slot:\"reference\"},slot:\"reference\"},[t._v(\"查看分类销售额\")])],1)]}}],null,!1,2196270900)})],1):t._e()],1):a(\"div\",{staticClass:\"app-container\"},[a(\"h2\",[t._v(\" 并没有权限查看 Please Get out! \")]),t._v(\" \"),a(\"img\",{attrs:{src:t.errGif,width:\"400\",height:\"400\",alt:\"No Access\"}})])};r._withStripped=!0;a(\"rGqo\");var l=a(\"23J+\"),n=a(\"GvKO\"),s=a.n(n),i=a(\"xUCC\"),o=a(\"ZySA\"),c=(a(\"7Qib\"),a(\"Mz3J\")),_=a(\"L2JU\"),p=a(\"wd/R\"),d=a.n(p),u={name:\"ComplexTable\",components:{Pagination:c.a},directives:{waves:o.a},filters:{},data:function(){return{tableKey:0,listLoading:!1,sales:null,listQuery:{page:1,limit:100,date:[]},rowSpans:null,errGif:s.a}},created:function(){this.listQuery.date=[new Date,d()().add(1,\"months\")]},computed:Object(l.a)({},Object(_.b)([\"id\",\"role\"])),beforeRouteEnter:function(t,e,a){a(function(t){t.getReport(),a()})},methods:{calculateRowSpan:function(){var t=[],e=0;this.sales.forEach(function(a){var r=!1;if(t.forEach(function(t){t.region_id===a.region_id&&(r=!0,t.end++,t.rowSpan++,e=t.start+t.rowSpan)}),!r){var l={region_id:a.region_id,start:e,end:e+1,rowSpan:1};e++,t.push(l)}}),this.rowSpans=t},getReport:function(){var t=this;1!==this.role&&6!==this.role||(this.listLoading=!0,this.listQuery.date&&this.listQuery.date.length>1&&(this.listQuery.start_date=d()(this.listQuery.date[0]).format(\"YYYY-MM-01\"),this.listQuery.end_date=d()(this.listQuery.date[1]).format(\"YYYY-MM-01\")),i.a.getGeneralSalesReport(this.listQuery).then(function(e){var a=[];t.listLoading=!1,e.forEach(function(t){var e=!1;if(a.forEach(function(a){if(a.area_id===t.area_id){var r={product_type_id:t.product_type_id,product_type_title:t.product_type_title,total_product_sales:t.total_product_sales};a.products_sales.push(r),e=!0}}),!e){var r={region_id:t.region_id,region_title:t.region_title,region_manager_id:t.region_manager_id,region_manager_name:t.region_manager_name,area_id:t.area_id,area_title:t.area_title,area_manager_name:t.area_manager_name,area_total_sales:t.area_total_sales,region_total_sales:t.region_total_sales,products_sales:[{product_type_id:t.product_type_id,product_type_title:t.product_type_title,total_product_sales:t.total_product_sales}]};a.push(r)}}),t.sales=a,t.calculateRowSpan()}).catch(function(e){t.$message({message:\"getAllSales 读取库存失败，请联系徐神检查\",type:\"error\"}),t.listLoading=!1}))},objectSpanMethod:function(t){t.row,t.column;var e=t.rowIndex;if(t.columnIndex<3){var a={rowspan:0,colspan:0};return this.rowSpans.forEach(function(t){e>=t.start&&e<t.end&&(e-t.start)%t.rowSpan==0&&(a={rowspan:t.rowSpan,colspan:1})}),a}},handleFilter:function(){this.getReport()}}},f=(a(\"9R6f\"),a(\"KHd+\")),h=Object(f.a)(u,r,[],!1,null,\"24303d2b\",null);h.options.__file=\"src/views/report/general-sales-report.vue\";e.default=h.exports}}]);","extractedComments":[]}