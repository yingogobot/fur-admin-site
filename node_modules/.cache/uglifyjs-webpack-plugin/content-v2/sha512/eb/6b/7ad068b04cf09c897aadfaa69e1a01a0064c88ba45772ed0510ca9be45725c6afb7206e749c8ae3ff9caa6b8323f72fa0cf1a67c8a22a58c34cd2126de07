{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{\"86NN\":function(t,e,n){\"use strict\";var o=n(\"DyJX\");e.a={fetchAllInventorys:function(t){return new Promise(function(e,n){o.a.post(\"inventory/all_inventorys\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllInventoryCount:function(t){return new Promise(function(e,n){var r={inventory_type:t};o.a.post(\"inventory/count_inventorys\",r).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllInventoryTpes:function(t){return new Promise(function(e,n){var r={inventory_type:t};o.a.post(\"inventory/inventory_types\",r).then(function(t){return e(t)}).catch(function(t){return n(t)})})},addNewInventoryRequest:function(t){return new Promise(function(e,n){o.a.post(\"inventory/add\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getStorage:function(){return new Promise(function(t,e){o.a.post(\"inventory/storage\").then(function(e){return t(e)}).catch(function(t){return e(t)})})},getProductStorage:function(t){return new Promise(function(e,n){var r={product_id:t};o.a.post(\"inventory/storage\",r).then(function(t){return e(t)}).catch(function(t){return n(t)})})}}},Mz3J:function(t,e,n){\"use strict\";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"pagination-container\",class:{hidden:t.hidden}},[n(\"el-pagination\",t._b({attrs:{background:t.background,\"current-page\":t.currentPage,\"page-size\":t.pageSize,layout:t.layout,\"page-sizes\":t.pageSizes,total:t.total},on:{\"update:currentPage\":function(e){t.currentPage=e},\"update:current-page\":function(e){t.currentPage=e},\"update:pageSize\":function(e){t.pageSize=e},\"update:page-size\":function(e){t.pageSize=e},\"size-change\":t.handleSizeChange,\"current-change\":t.handleCurrentChange}},\"el-pagination\",t.$attrs,!1))],1)};o._withStripped=!0;n(\"xfY5\");Math.easeInOutQuad=function(t,e,n,o){return(t/=o/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e};var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};function i(t,e,n){var o=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,i=t-o,u=0;e=void 0===e?500:e;!function t(){u+=20;var a,c=Math.easeInOutQuad(u,o,i,e);a=c,document.documentElement.scrollTop=a,document.body.parentNode.scrollTop=a,document.body.scrollTop=a,u<e?r(t):n&&\"function\"==typeof n&&n()}()}var u={name:\"Pagination\",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:\"total, sizes, prev, pager, next, jumper\"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit(\"update:page\",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit(\"update:limit\",t)}}},methods:{handleSizeChange:function(t){this.$emit(\"pagination\",{page:this.currentPage,limit:t}),this.autoScroll&&i(0,800)},handleCurrentChange:function(t){this.$emit(\"pagination\",{page:t,limit:this.pageSize}),this.autoScroll&&i(0,800)}}},a=(n(\"VhpY\"),n(\"KHd+\")),c=Object(a.a)(u,o,[],!1,null,\"72233bcd\",null);c.options.__file=\"src/components/Pagination/index.vue\";e.a=c.exports},RJdx:function(t,e,n){},UE2R:function(t,e,n){\"use strict\";var o=n(\"Y2ow\");n.n(o).a},VhpY:function(t,e,n){\"use strict\";var o=n(\"RJdx\");n.n(o).a},Y2ow:function(t,e,n){},ZySA:function(t,e,n){\"use strict\";n(\"jUE0\");var o=\"@@wavesContext\";function r(t,e){function n(n){var o=Object.assign({},e.value),r=Object.assign({ele:t,type:\"hit\",color:\"rgba(0, 0, 0, 0.15)\"},o),i=r.ele;if(i){i.style.position=\"relative\",i.style.overflow=\"hidden\";var u=i.getBoundingClientRect(),a=i.querySelector(\".waves-ripple\");switch(a?a.className=\"waves-ripple\":((a=document.createElement(\"span\")).className=\"waves-ripple\",a.style.height=a.style.width=Math.max(u.width,u.height)+\"px\",i.appendChild(a)),r.type){case\"center\":a.style.top=u.height/2-a.offsetHeight/2+\"px\",a.style.left=u.width/2-a.offsetWidth/2+\"px\";break;default:a.style.top=(n.pageY-u.top-a.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+\"px\",a.style.left=(n.pageX-u.left-a.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+\"px\"}return a.style.backgroundColor=r.color,a.className=\"waves-ripple z-active\",!1}}return t[o]?t[o].removeHandle=n:t[o]={removeHandle:n},n}var i={bind:function(t,e){t.addEventListener(\"click\",r(t,e),!1)},update:function(t,e){t.removeEventListener(\"click\",t[o].removeHandle,!1),t.addEventListener(\"click\",r(t,e),!1)},unbind:function(t){t.removeEventListener(\"click\",t[o].removeHandle,!1),t[o]=null,delete t[o]}},u=function(t){t.directive(\"waves\",i)};window.Vue&&(window.waves=i,Vue.use(u)),i.install=u;e.a=i},cGyR:function(t,e,n){\"use strict\";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"app-container\"},[n(\"div\",{staticClass:\"filter-container\"},[n(\"h2\",[t._v(\"筛选结果\")]),t._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"产品类型\",clearable:\"\"},on:{change:function(e){return t.getSubType(t.listQuery.product_type)}},model:{value:t.listQuery.product_type,callback:function(e){t.$set(t.listQuery,\"product_type\",e)},expression:\"listQuery.product_type\"}},t._l(t.productTypes,function(t){return n(\"el-option\",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),t._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"产品分类\",clearable:\"\"},on:{change:function(e){return t.getSelectedProducts(t.listQuery.product_sub_type)}},model:{value:t.listQuery.product_sub_type,callback:function(e){t.$set(t.listQuery,\"product_sub_type\",e)},expression:\"listQuery.product_sub_type\"}},t._l(t.productSubTypes,function(t){return n(\"el-option\",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),t._v(\" \"),n(\"el-select\",{staticClass:\"filter-item\",staticStyle:{width:\"150px\",\"margin-left\":\"15px\"},attrs:{placeholder:\"产品\",clearable:\"\"},model:{value:t.listQuery.product,callback:function(e){t.$set(t.listQuery,\"product\",e)},expression:\"listQuery.product\"}},t._l(t.selectedProducts,function(t){return n(\"el-option\",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),t._v(\" \"),n(\"el-button\",{directives:[{name:\"waves\",rawName:\"v-waves\"}],staticClass:\"filter-item\",staticStyle:{width:\"100px\",\"margin-left\":\"15px\"},attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:t.handleFilter}},[t._v(\"\\n      搜索\\n    \")])],1),t._v(\" \"),n(\"h2\",[t._v(\"库存详情\")]),t._v(\" \"),n(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],key:t.tableKey,staticStyle:{width:\"100%\"},attrs:{data:t.inventories,\"span-method\":t.objectSpanMethod,border:\"\",fit:\"\",\"highlight-current-row\":\"\"}},[n(\"el-table-column\",{attrs:{label:\"产品ID\",prop:\"id\",width:\"100px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var o=e.row;return[n(\"span\",[t._v(t._s(o.product_id))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品类型\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var o=e.row;return[n(\"el-tag\",{staticClass:\"tag\",attrs:{color:o.tag_color}},[t._v(t._s(o.product_type))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品细类\",width:\"150px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var o=e.row;return[n(\"el-tag\",{staticClass:\"sub_type_tag\",attrs:{color:o.sub_type_tag_color}},[t._v(t._s(o.product_sub_type))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品名称\",width:\"200px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var o=e.row;return[n(\"span\",{staticClass:\"link-type\",on:{click:function(e){return t.handleUpdate(o)}}},[t._v(t._s(o.title))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"产品型号\",width:\"200px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var o=e.row;return[n(\"span\",[t._v(t._s(o.size))])]}}])}),t._v(\" \"),n(\"el-table-column\",{attrs:{label:\"剩余数量\",\"min-width\":\"300px\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var o=e.row;return[n(\"span\",{staticClass:\"quantity\",class:{\"low-quantity\":o.quantity<=300}},[t._v(t._s(o.quantity))])]}}])})],1),t._v(\" \"),n(\"pagination\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.total>0,expression:\"total>0\"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{\"update:page\":function(e){return t.$set(t.listQuery,\"page\",e)},\"update:limit\":function(e){return t.$set(t.listQuery,\"limit\",e)},pagination:t.getAllStorage}})],1)};o._withStripped=!0;n(\"rGqo\");var r=n(\"23J+\"),i=n(\"86NN\"),u=n(\"xMja\"),a=n(\"ZySA\"),c=(n(\"7Qib\"),n(\"Mz3J\")),s=n(\"L2JU\"),l={name:\"ComplexTable\",components:{Pagination:c.a},directives:{waves:a.a},filters:{},data:function(){return{tableKey:0,inventories:null,productTypes:[],productSubTypes:[],selectedProducts:[],total:0,listLoading:!0,rowSpans:null,listQuery:{page:1,limit:10,product_type:void 0,product_sub_type:void 0,product:void 0}}},created:function(){},computed:Object(r.a)({},Object(s.b)([\"id\"])),beforeRouteEnter:function(t,e,n){n(function(t){t.getAllStorage(),t.getProductTypes(),n()})},methods:{getAllStorage:function(){var t=this;this.listLoading=!0,i.a.getStorage().then(function(e){t.inventories=e,t.listLoading=!1,t.calculateRowSpan()}).catch(function(e){t.$message({message:\"读取库存失败，请联系徐神检查\",type:\"error\"}),t.listLoading=!1})},getProductTypes:function(){var t=this;u.a.getAllProductType().then(function(e){t.productTypes=e})},getSubType:function(t,e){var n=this;this.listQuery.product=void 0,this.listQuery.product_sub_type=void 0,this.productSubTypes=[],this.selectedProducts=[],t&&u.a.getProductSubType({product_type_id:t}).then(function(t){n.productSubTypes=t}),e&&(e.product_sub_type=void 0,e.product_id=void 0,e.cost=void 0,e.size=void 0,e.quantity=void 0)},getSelectedProducts:function(t){var e=this;this.listQuery.product=void 0,this.selectedProducts=[],t&&u.a.getProductBySubType({product_sub_type:t}).then(function(t){e.selectedProducts=t})},handleFilter:function(){this.listQuery.page=1,this.getAllStorage()},calculateRowSpan:function(){var t=[],e=0;this.inventories.forEach(function(n){var o=!1;if(t.forEach(function(t){t.id===n.product_sub_type_id&&(o=!0,t.end++,t.rowSpan++,e=t.start+t.rowSpan)}),!o){var r={id:n.product_sub_type_id,start:e,end:e+1,rowSpan:1};e++,t.push(r)}}),this.rowSpans=t},objectSpanMethod:function(t){t.row,t.column;var e=t.rowIndex,n=t.columnIndex;if(1===n||2===n){var o={rowspan:0,colspan:0};return this.rowSpans.forEach(function(t){e>=t.start&&e<t.end&&(e-t.start)%t.rowSpan==0&&(o={rowspan:t.rowSpan,colspan:1})}),o}}}},p=(n(\"UE2R\"),n(\"KHd+\")),d=Object(p.a)(l,o,[],!1,null,\"fc98cdce\",null);d.options.__file=\"src/views/inventory/storage-check.vue\";e.default=d.exports},jUE0:function(t,e,n){},xMja:function(t,e,n){\"use strict\";var o=n(\"DyJX\");e.a={addProduct:function(t){return new Promise(function(e,n){o.a.post(\"product/add\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProducts:function(t){return new Promise(function(e,n){o.a.post(\"product/get_all_products\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProductCount:function(t){return new Promise(function(e,n){o.a.post(\"product/get_all_products_count\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProductType:function(){return new Promise(function(t,e){o.a.post(\"product/get_all_product_type\").then(function(e){return t(e)}).catch(function(t){return e(t)})})},getAllProductTypeCount:function(){return new Promise(function(t,e){o.a.post(\"product/get_all_product_type_count\").then(function(e){return t(e)}).catch(function(t){return e(t)})})},getProductSubType:function(t){return new Promise(function(e,n){o.a.post(\"product/get_product_sub_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProductSubType:function(t){return new Promise(function(e,n){o.a.post(\"product/get_all_product_sub_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},getAllProductSubTypeCount:function(){return new Promise(function(t,e){o.a.post(\"product/get_product_sub_type_count\").then(function(e){return t(e)}).catch(function(t){return e(t)})})},getProductBySubType:function(t){return new Promise(function(e,n){o.a.post(\"product/get_product_by_sub_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},addProductType:function(t){return new Promise(function(e,n){o.a.post(\"product/add_product_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})},addProductSubType:function(t){return new Promise(function(e,n){o.a.post(\"product/add_product_sub_type\",t).then(function(t){return e(t)}).catch(function(t){return n(t)})})}}}}]);","extractedComments":[]}