{"remainingRequest":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/src/views/member/member-sales-detail.vue?vue&type=style&index=0&id=bcf471ac&lang=scss&scoped=true&","dependencies":[{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/src/views/member/member-sales-detail.vue","mtime":1585724911809},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yinxu/Desktop/Dev/Fur-Admin/fur-admin-site/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.title {\n  display: inline-block;\n}\n\n.create-button {\n  margin-left: 50px !important;\n}\n\n.tag {\n  color: white;\n  font-size: 14px;\n  width: 100px;\n}\n\n.sub_type_tag {\n  color: white;\n  font-size: 14px;\n  width: 120px;\n}\n.input-title {\n  display: inline-block;\n  width: 150px;\n  line-height: 25px;\n  font-size: 14px;\n  margin-left: 10px;\n}\n",{"version":3,"sources":["member-sales-detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8OA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"member-sales-detail.vue","sourceRoot":"src/views/member","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div>\n      <h2 class=\"title\">会员消费详情</h2>\n      <div v-if=\"this.member\" style=\"margin-bottom: 30px;\" >\n        <div style=\"display: inline-block; margin-right: 30px; font-size: 24px\" >\n          会员id：{{this.member.id}}\n        </div>\n        <div style=\"display: inline-block; margin-right: 30px; font-size: 24px\" >\n          会员名称：{{this.member.name}}\n        </div>\n      </div>\n    </div>\n    <el-table\n      :key=\"tableKey\"\n      v-loading=\"listLoading\"\n      :data=\"sales\"\n      :span-method=\"objectSpanMethod\"\n      border\n      fit\n      highlight-current-row\n      style=\"width: 100%;\"\n    >\n      <el-table-column label=\"销售订单ID\" prop=\"id\" width=\"100px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.sales_id }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"销售渠道\" prop=\"cellphone\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.title }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"下单日期\" prop=\"cellphone\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{moment(row.sales_date).format('YYYY-MM-DD')}}</span>\n        </template>\n      </el-table-column>\n       <el-table-column label=\"订单优惠\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.coupon }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"订单折扣\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.discount }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"手动改价\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.manual_discount }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"运费成本\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.shipping_cost }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"其他成本\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.other_cost }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"订单总价\" prop=\"cellphone\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.order_total_price }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"订单总利润\" prop=\"cellphone\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.order_total_profit }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"产品类型\" width=\"150px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <el-tag class=\"tag\" :color=\"row.product_type_tag_color\">{{ row.product_type_title }}</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"产品细类\" width=\"150px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <el-tag class=\"sub_type_tag\" :color=\"row.product_sub_type_tag_color\">{{ row.product_sub_type_title }}</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"产品名称\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.product_title }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"销售时产品价格\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.per_item_price_atm }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"销售时产品成本\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.per_item_cost_atm }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"数量\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.quantity }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"产品优惠\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.per_product_discount }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"产品折扣\" prop=\"wechat_account\" width=\"200px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.per_product_discount_ratio }}</span>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\nimport SalesAPI from '@/api/sales'\nimport MemberAPI from '@/api/member'\n\nimport { parseTime } from '@/utils'\nimport Pagination from '@/components/Pagination' // secondary package based on el-pagination\nimport { mapGetters } from 'vuex'\nimport moment from 'moment'\n\nexport default {\n  name: 'ComplexTable',\n  components: { Pagination },\n  filters: {},\n  data() {\n    return {\n      tableKey: 0,\n      member: null,\n      sales: null,\n      total: 0,\n      listLoading: true,\n      rowSpans: null,\n    }\n  },\n  created() {\n   \n  },\n  computed: {\n    ...mapGetters([\n      'id'\n    ])\n  },\n  beforeRouteEnter (to, from, next) {\n    next(vm => { \n      vm.getMemberInfo()\n      vm.getSalesDetail()\n      next();\n    }) \n  },\n  methods: {\n    calculateRowSpan() {\n      let g = []\n      let count = 0\n      this.sales.forEach(i => {\n        let found = false\n        \n        g.forEach(t => {\n          if (t.sales_id === i.sales_id) {\n            found = true\n            t.end++\n            t.rowSpan++\n            count = t.start + t.rowSpan\n          }\n        })\n\n        if (!found) {\n          let newT = {\n            sales_id: i.sales_id,\n            start: count,\n            end: count+1,\n            rowSpan: 1\n          }\n          count++\n          g.push(newT)\n        }\n      });\n      console.log(g)\n      this.rowSpans = g;\n    },\n    getSalesDetail() {\n      this.listLoading = true\n      SalesAPI.getSalesDetailForMember(this.$route.params.id)\n        .then(response => {\n          this.sales = response\n          this.listLoading = false\n          this.calculateRowSpan()\n        })\n        .catch(err => {\n          this.$message({\n            message: '读取库存失败，请联系徐神检查',\n            type: 'error'\n          })\n          this.listLoading = false\n        })\n    },\n    getMemberInfo() {\n      this.listLoading = true\n      MemberAPI.getMemberById(this.$route.params.id)\n        .then(response => {\n          this.member = response\n        })\n        .catch(err => {\n          this.$message({\n            message: '读取库存失败，请联系徐神检查',\n            type: 'error'\n          })\n        })\n    },\n    objectSpanMethod({ row, column, rowIndex, columnIndex }) {\n      if (columnIndex <= 9 ) {\n        let data = {\n          rowspan: 0,\n          colspan: 0\n        };\n        this.rowSpans.forEach(i => {\n          if (rowIndex >= i.start && rowIndex < i.end && (rowIndex - i.start) % i.rowSpan === 0) {\n            data = {\n              rowspan: i.rowSpan,\n              colspan: 1\n            };\n            return;\n          }\n        })\n\n        return data;\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n  .title {\n    display: inline-block;\n  }\n\n  .create-button {\n    margin-left: 50px !important;\n  }\n\n  .tag {\n    color: white;\n    font-size: 14px;\n    width: 100px;\n  }\n\n  .sub_type_tag {\n    color: white;\n    font-size: 14px;\n    width: 120px;\n  }\n  .input-title {\n    display: inline-block;\n    width: 150px;\n    line-height: 25px;\n    font-size: 14px;\n    margin-left: 10px;\n  }\n</style>\n"]}]}